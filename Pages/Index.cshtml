@page
@using CosmosOdyssey.Models
@using Microsoft.EntityFrameworkCore
@model IndexModel
<!DOCTYPE html>
<html lang="en">
<head>
    <title>@ViewData["Title"]</title>
    <!-- Add your CSS and scripts here -->
</head>
<body>
<div class="text-center">
    <h1 class="display-4">Welcome to CosmosOdyssey!</h1>
    
    <h2 size="14px">Most trusted space flight booking site since 2023!</h2>
    
    <div>
        <form method="post">
            <label for="from">From:</label>
            <select id="from" name="fromSelection" asp-for="fromSelection">
                <option value="" hidden>Select something</option>
                @foreach (var t in Model.Planets){
                    <option value="@t">@t</option>
                }
            </select>
            <label for="to">To:</label>
            <select id="to" name="toSelection" asp-for="toSelection">
                <option value="" hidden>Select something</option>
                @foreach (var t in Model.Planets){
                    <option value="@t">@t</option>
                }
            </select>
            <button type="submit">Go!</button>
        </form>
    </div>
    <div>
        @if (Model.RouteOptions != null){ //TODO: Make the tables actually look nice
            <h3>Found @Model.RouteOptions.Count available route(s) from @Model.RouteOptions[0][0].From to @Model.RouteOptions[^1][^1].To</h3>
            <p>Click on the routes to see more information</p>
            foreach (var FullRoute in Model.RouteOptions){ //For creating the buttons. In separate foreach for better user experience
                <button onclick="ShowTable('@Model.FullRouteToText(FullRoute)')">@Model.FullRouteToText(FullRoute)</button>
            }
            foreach (var FullRoute in Model.RouteOptions){//Goes through all the route options
                <Table id="@Model.FullRouteToText(FullRoute)" style="display: none;">
                        @foreach (var Route in FullRoute){
                                //Goes through every leg in a full route
                                <tr>
                                    <td>From @Route.From</td>
                                    <td>to @Route.To</td>
                                    <td>Distance @Route.Distance</td>
                                </tr>
                                <tr><td>Providers:</td></tr>
                                @foreach (var provider in Route.Providers){
                                    <tr>
                                        <td>@provider.company.name</td>
                                        <td>@provider.price</td>
                                        <td>@provider.flightStart</td>
                                        <td>@provider.flightEnd</td>
                                    </tr>
                                }
                            }
                </Table>
            }
        }
    </div>
</div>
</body>
<script>
    function ShowTable(tableId) {
        var tables = document.querySelectorAll('table');
        tables.forEach(function (table) {
            if (table.id === tableId) {
                table.style.display = 'table';
            } else {
                table.style.display = 'none';
            }
        });
    }
</script>
</html>